<div><div class="reading-title css-1hxq2bi"><h1 class="cds-859 css-1diqjn6 cds-861" tabindex="-1">Monitor data quality with SQL</h1><div class="css-1kuhxiq"></div></div><div class="rc-CML" dir="auto"><div><div data-track="true" data-track-app="open_course_home" data-track-page="item_layout" data-track-action="click" data-track-component="cml" role="presentation"><div data-track="true" data-track-app="open_course_home" data-track-page="item_layout" data-track-action="click" data-track-component="cml_link"><div data-testid="cml-viewer" class="css-1k5v0wb"><p data-text-variant="body1"><span><span>As you’ve learned, it is important to monitor data quality. By monitoring your data, you become aware of any problems that may occur within the ETL pipeline and data warehouse design. This can help you address problems as early as possible and avoid future problems.</span></span></p><p data-text-variant="body1"><span><span>In this reading, you’ll follow a fictional scenario where a BI engineer performs quality testing on their pipeline and suggests SQL queries that one could use for each step of testing.</span></span></p><h2><span><span>The scenario</span></span></h2><p data-text-variant="body1"><span><span>At Francisco’s Electronics, an electronics manufacturing company, a BI engineer named Sage designed a data warehouse for analytics and reporting. After the ETL process design, Sage created a diagram of the schema.</span></span></p><div><span><span></span></span><figure role="figure" contenteditable="false"><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/5ERwxdyMQyyEcMXcjIMsBQ_58a5f9526c2a413dac69340667cda1f1_Google-BI-Cert-Original-ERD.png?expiry=1687046400000&amp;hmac=PgpD5OuB90LPVSUUMjFfcmGBYO2soRls-JCQ76p3UTs" alt="The sales_warehouse database schema. The Sales table connects to the Products, Users, Locations, and Orders tables." data-asset-id="5ERwxdyMQyyEcMXcjIMsBQ" class="cml-image-default undefined"></figure></div><p><span><span>The diagram of the schema of the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database contains different symbols and connectors that represent two important pieces of information: the major tables within the system and the relationships among these tables.</span></span></p><p data-text-variant="body1"><span><span>The </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database schema contains five tables:</span></span></p><ul><li><p data-text-variant="body1"><span><span>Sales&nbsp;</span></span></p></li><li><p data-text-variant="body1"><span><span>Products</span></span></p></li><li><p data-text-variant="body1"><span><span>Users</span></span></p></li><li><p data-text-variant="body1"><span><span>Locations</span></span></p></li><li><p data-text-variant="body1"><span><span>Orders</span></span></p></li></ul><p data-text-variant="body1"><span><span>These tables are connected via keys. The tables contain five to eight columns (or attributes) ranging in data type. The data types include varchar or char (or character), integer, decimal, date, text (or string), timestamp, and bit.</span></span></p><p data-text-variant="body1"><span><span>The foreign keys in the Sales table link to each of the other tables:</span></span></p><ul><li><p data-text-variant="body1"><span><span>The “product_id” foreign key links to the Products table</span></span></p></li><li><p data-text-variant="body1"><span><span>The “user_id” foreign key links to the Users table</span></span></p></li><li><p data-text-variant="body1"><span><span>The “order_id” foreign key links to the Orders table&nbsp;</span></span></p></li><li><p data-text-variant="body1"><span><span>The “shipping_address_id” and “billing_address_id” foreign keys link to the Locations table</span></span></p></li></ul><p data-text-variant="body1"><span><span>After Sage made the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database, the development team made changes to the sales site. As a result, the original OLTP database changed. Now, Sage needs to ensure the ETL pipeline works properly and that the warehouse data matches the original OLTP database.&nbsp;</span></span></p><p><span><span>Sage used the original OLTP schema from the </span></span><span><strong><span>store </span></strong></span><span><span>database to design the warehouse.</span></span></p><div><span><span></span></span><figure role="figure" contenteditable="false"><img src="https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/hVHgrZkHT1WEyWvsWe9BQg_45f2b6fdc9e14cd9af1214a05a9b14f1_BI_R-121_2.png?expiry=1687046400000&amp;hmac=XXLD01yUkefNrj_OETWt3oHlGT6aIltdBv7C3VqU-2g" alt="The original store database schema. The Sales table connects to the Products, Users, Locations, and Orders tables." data-asset-id="hVHgrZkHT1WEyWvsWe9BQg" class="cml-image-default undefined"></figure></div><p><span><span>The </span></span><span><strong><span>store</span></strong></span><span><span> database schema also contains five tables—Sales, Products, Users, Locations, and Orders—which are connected via keys. The tables contain four to eight columns ranging in data type. The data types include varchar or char, integer, decimal, date, text, timestamp, bit, tinyint, and datetime.</span></span></p><p><span><span>Every table in the </span></span><span><strong><span>store</span></strong></span><span><span> database has an </span></span><span><strong><span>id</span></strong></span><span><span> field as a primary key. The database contains the following tables:</span></span></p><ul><li><p><span><span>The </span></span><span><strong><span>Sales</span></strong></span><span><span> table has price, quantity, and date columns. It references a user who made a sale (</span></span><span><strong><span>UserId</span></strong></span><span><span>), purchased a product (</span></span><span><strong><span>ProductId</span></strong></span><span><span>), and a related order (</span></span><span><strong><span>OrderId</span></strong></span><span><span>). Also, it references the </span></span><span><strong><span>Locations</span></strong></span><span><span> table for shipping and billing addresses (</span></span><span><strong><span>ShippingAddressId</span></strong></span><span><span> and </span></span><span><strong><span>BillingAddressId,</span></strong></span><span><span> respectively).</span></span></p></li><li><p><span><span>The </span></span><span><strong><span>Users</span></strong></span><span><span> table has </span></span><span><strong><span>FirstName</span></strong></span><span><span>, </span></span><span><strong><span>LastName</span></strong></span><span><span>, </span></span><span><strong><span>Email</span></strong></span><span><span>, </span></span><span><strong><span>Password,</span></strong></span><span><span> and other user-related columns.</span></span></p></li><li><p><span><span>The </span></span><span><strong><span>Locations</span></strong></span><span><span> table contains address information (</span></span><span><strong><span>Address1</span></strong></span><span><span>, </span></span><span><strong><span>Address2</span></strong></span><span><span>, </span></span><span><strong><span>City</span></strong></span><span><span>, </span></span><span><strong><span>State,</span></strong></span><span><span> and </span></span><span><strong><span>Postcode</span></strong></span><span><span>).</span></span></p></li><li><p><span><span>The </span></span><span><strong><span>Products</span></strong></span><span><span> table has </span></span><span><strong><span>Name</span></strong></span><span><span>, </span></span><span><strong><span>Price</span></strong></span><span><span>, </span></span><span><strong><span>InventoryNumber,</span></strong></span><span><span> and </span></span><span><strong><span>Category</span></strong></span><span><span> of products.</span></span></p></li><li><p><span><span>The </span></span><span><strong><span>Orders</span></strong></span><span><span> table has </span></span><span><strong><span>OrderNumber</span></strong></span><span><span> and purchase information (</span></span><span><strong><span>Subtotal</span></strong></span><span><span>, </span></span><span><strong><span>ShippingFee</span></strong></span><span><span>, </span></span><span><strong><span>Tax</span></strong></span><span><span>, </span></span><span><strong><span>Total,</span></strong></span><span><span> and </span></span><span><strong><span>Status</span></strong></span><span><span>).</span></span></p></li></ul><h2 data-heading-variant="h2semibold"><span><span>Using SQL to find problems</span></span></h2><p><span><span>Sage compared the </span></span><span><strong><span>sales_warehouse </span></strong></span><span><span>database to the original </span></span><span><strong><span>store</span></strong></span><span><span> database to check for completeness, consistency, conformity, accuracy, redundancy, integrity, and timeliness. Sage ran SQL queries to examine the data and identify quality problems. Then Sage prepared the following table of lists, which include the types of quality issues found, the quality strategies that were violated, the SQL codes used to find the issues, and specific descriptions of the issues.</span></span></p><h3 data-heading-variant="h3bold"><span><strong><span>Quality testing </span></strong></span><span><em><strong><span>sales_warehouse</span></strong></em></span></h3><div class="css-1yr0py9"><table><thead><tr><th scope="col"><p><span><strong><span>Tested quality</span></strong></span></p></th><th scope="col"><p><span><strong><span>Quality strategy</span></strong></span></p></th><th scope="col"><p><span><strong><span>SQL query</span></strong></span></p></th><th scope="col"><p><span><strong><span>Sage’s observation</span></strong></span></p></th></tr></thead><tbody><tr><td><p><span><span>Integrity</span></span></p></td><td><p><span><span>Is the data accurate, complete, consistent, and trustworthy?</span></span></p></td><td><p><span><strong><span>SELECT * </span></strong></span><span><span>
</span></span><span><strong><span>FROM Orders</span></strong></span></p></td><td><p><span><span>In the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database, the order with ID 7 has the incorrect total value.&nbsp;</span></span></p></td></tr><tr><td><p><span><span>Completeness</span></span></p></td><td><p><span><span>Does the data contain all of the desired components or measures?</span></span></p></td><td><p><span><strong><span>SELECT COUNT(*) </span></strong></span><span><span>
</span></span><span><strong><span>FROM Locations</span></strong></span></p></td><td><p><span><span>The</span></span><span><strong><span> Locations</span></strong></span><span><span> table of the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database has an extra address. In the </span></span><span><strong><span>store</span></strong></span><span><span> database there are 60 records, whereas the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database table has 61.</span></span></p></td></tr><tr><td><p><span><span>Consistency</span></span></p></td><td><p><span><span>Is the data compatible and in agreement across all systems?</span></span></p></td><td><p><span><strong><span>SELECT Phone </span></strong></span><span><span>
</span></span><span><strong><span>FROM Users</span></strong></span></p></td><td><p><span><span>Several users within the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database have phones without the "+" prefix.</span></span></p></td></tr><tr><td><p><span><span>Conformity</span></span></p></td><td><p><span><span>Does the data fit the required destination format?</span></span></p></td><td><p><span><strong><span>SELECT id, postcode </span></strong></span><span><span>
</span></span><span><strong><span>FROM sales_warehouse.Locations</span></strong></span></p></td><td><p><span><span>The location ZIP code for the record with ID 6 in the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database is 722434213, which is wrong. The United States postal code contains either five digits or five digits followed by a hyphen (dash) and another four digits (e.g., 12345-1234).</span></span></p></td></tr></tbody></table></div><h3 data-heading-variant="h3bold"><span><strong><span>Quality testing </span></strong></span><span><em><strong><span>store</span></strong></em></span></h3><div class="css-1yr0py9"><table><thead><tr><th scope="col"><p><span><strong><span>Feature</span></strong></span></p></th><th scope="col"><p><span><strong><span>Quality Strategy</span></strong></span></p></th><th scope="col"><p><span><strong><span>SQL query</span></strong></span></p></th><th scope="col"><p><span><strong><span>Sage’s Observation</span></strong></span></p></th></tr></thead><tbody><tr><td><p><span><span>Integrity</span></span></p></td><td><p><span><span>Is the data accurate, complete, consistent, and trustworthy?</span></span></p></td><td><p><span><strong><span>DESCRIBE Users</span></strong></span></p></td><td><p><span><strong><span>Users.Status</span></strong></span><span><span> from the </span></span><span><strong><span>store</span></strong></span><span><span> database and </span></span><span><strong><span>Users.is_active</span></strong></span><span><span> from the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database seem to be related fields. However, it is not obvious how the </span></span><span><strong><span>Status</span></strong></span><span><span> column is transformed into the </span></span><span><strong><span>is_active</span></strong></span><span><span> boolean column. Is it possible that with a new status value, the ETL pipeline will fail?</span></span></p></td></tr><tr><td><p><span><span>Consistency</span></span></p></td><td><p><span><span>Is the data compatible and in agreement across all systems?</span></span></p></td><td><p><span><strong><span>DESCRIBE Products</span></strong></span></p></td><td><p><span><strong><span>Products.Inventory</span></strong></span><span><span> from the </span></span><span><strong><span>store</span></strong></span><span><span> database has the </span></span><span><strong><span>varchar</span></strong></span><span><span> type instead of the </span></span><span><strong><span>int(10)</span></strong></span><span><span> in the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database </span></span><span><strong><span>Products.inventory</span></strong></span><span><span> field. This can be a problem if there is a value with characters.</span></span></p></td></tr><tr><td><p><span><span>Accuracy</span></span></p></td><td><p><span><span>Does the data conform to the actual entity being measured or described?</span></span></p></td><td><p><span><strong><span>DESCRIBE Sales</span></strong></span></p></td><td><p><span><span>The data type of </span></span><span><strong><span>Sales.Date</span></strong></span><span><span> in the </span></span><span><strong><span>store</span></strong></span><span><span> database is different from its data type in </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> (</span></span><span><strong><span>date</span></strong></span><span><span> vs </span></span><span><strong><span>datetime</span></strong></span><span><span>). It might not be a problem if time is not important for the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database fact table.&nbsp;</span></span></p></td></tr><tr><td><p><span><span>Redundancy</span></span></p></td><td><p><span><span>Is only the necessary data being moved, transformed, and stored for use?</span></span></p></td><td><p><span><strong><span>DESCRIBE Sales</span></strong></span></p></td><td><p><span><span>The table </span></span><span><strong><span>Sales</span></strong></span><span><span> from the </span></span><span><strong><span>sales_warehouse</span></strong></span><span><span> database has a unique index constraint on </span></span><span><strong><span>OrderId</span></strong></span><span><span>, </span></span><span><strong><span>ProductId</span></strong></span><span><span>, </span></span><span><strong><span>UserId</span></strong></span><span><span> columns. It can be added to the warehouse schema.</span></span></p></td></tr></tbody></table></div><h2 data-heading-variant="h2semibold"><span><span>Key takeaways</span></span></h2><p><span><span>Testing data quality is an essential skill of a BI professional that ensures good analytics and reporting. Just as Sage does in this example, you can use SQL commands to examine BI databases and find potential problems. The sooner you know the problems in your system, the sooner you can fix them and improve your data quality.</span></span></p><p><span><span>
</span></span></p><p><span><span>
</span></span></p><p><span><span>
</span></span></p></div></div></div></div></div><div data-testid="reading-complete-container" class="css-rj3g7z"><div><button class="cds-856 cds-827 cds-829  css-zosuv5 cds-838 cds-button-disableElevation" tabindex="0" type="submit" data-testid="mark-complete"><span class="cds-828 cds-button-label">Mark as completed</span></button></div></div></div>
